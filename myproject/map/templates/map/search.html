{% extends 'map/base.html' %}

{% block title %}Search & Filter - Business Store Location Manager{% endblock %}

{% block nav_links %}
{% include 'map/dashboard_nav.html' %}
{% endblock %}

{% block content %}
<div style="width: 100%; max-width: 1000px; margin: 0 auto; text-align: left;">
    <h1>Search & Filter</h1>

    <div class="card" style="padding: 2rem; margin-top: 2rem; margin-bottom: 2rem; max-width: 100%;">
        <form method="get" action="{% url 'search' %}">
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Search Name</label>
                <input type="text" name="q" value="{{ query }}" placeholder="Enter store name..."
                    style="width: 100%; padding: 0.8rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2); color: white;">
            </div>
            <div style="margin-bottom: 2rem;">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Category</label>
                <select name="category"
                    style="width: 100%; padding: 0.8rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2); color: white;">
                    <option value="">All Categories</option>
                    {% for cat in categories %}
                    <option value="{{ cat.value }}" {% if cat.selected %}selected{% endif %}>{{ cat.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" class="btn-primary" style="width: 100%; padding: 1rem;">Search</button>
        </form>
    </div>

    <div class="store-list">
        {% for store in stores %}
        <div class="card"
            style="padding: 1.5rem; max-width: 100%; margin-bottom: 1rem; border: 1px solid rgba(255,255,255,0.1); text-align: left;">
            <h3 style="margin-bottom: 0.5rem; color: var(--primary);">{{ store.name }}</h3>
            <p style="margin-bottom: 0.5rem;">{{ store.location }}</p>
            {% if store.category %}
            <p style="font-size: 0.95rem;">Category: {{ store.get_category_display }}</p>
            {% endif %}
            <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.05);">
                <a href="{% url 'edit_store' pk=store.pk %}"
                    style="color: var(--primary); text-decoration: none; font-weight: 600;">Edit Store Details</a>
            </div>
        </div>
        {% empty %}
        <div class="card" style="padding: 3rem; max-width: 100%; text-align: center;">
            <p style="color: var(--text-muted);">No locations found matching your current filters.</p>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 0.75rem center;
        background-size: 1rem;
    }

    option {
        background: #0f172a;
        color: white;
    }
</style>
{% endblock %}